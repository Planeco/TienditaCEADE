<?php

    require_once FOLDER_MODEL_EXTEND. "model.login_user.inc.php";
	require(LIB_CONEXION);
	
	#-----------------------------------------------------------------------------------------------------------------#
	#--------------------------------------------Inicializacion de control--------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#



	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	#-----------------------------------------------------------------------------------------------------------------#
	#----------------------------------------------------Funciones----------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


	#-----------------------------------------------------------------------------------------------------------------#
	#---------------------------------------------------Seccion AJAX--------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	$xajax = new xajax();
	function ingresar($email,$pass){
	    $r=new xajaxResponse();
	    global $dbLink;
	    if ($email == "")
	    {
	        $r->mostrarAviso("Ingresa tu email.");
	        return $r;
	    }
	    if ($pass == "")
	    {
	        $r->mostrarAviso("Ingresa tu contraseÃ±a.");
	        return $r;
	    }
	    
	    
	    
	    $login=new ModeloLogin_user();
	    $arrSesion=$login->validarUsuario(array('email'=>$email,'password'=>$pass));
	    
	    
	    if (!$arrSesion[0]){
	        $r->mostrarError($arrSesion[1]);
	        return $r;
	    }
	    
	    $objSession=new clsSession();
	    $objSession->updateTime();
	    $objSession->setObjetoGetInfo($arrSesion[1]);
	    $_SESSION['objSession']=serialize($objSession);
	    $r->mostrarExito('Datos correctos!');
	    $r->redirect("dashboard.php",3);
	    return $r;
	    
	    
	}
	$xajax->registerFunction("ingresar");
	

	$xajax->processRequest();

	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	#-----------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------Inicializacion de variables-------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


	#-----------------------------------------------------------------------------------------------------------------#
	#------------------------------------- JavaScript array initialization     ---------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


